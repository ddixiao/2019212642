webpackJsonp([2],{"+xsn":function(t,i){},"9xhi":function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=s("txtP"),e=s.n(a);for(var r in a)"default"!==r&&function(t){s.d(i,t,function(){return a[t]})}(r);var n=s("O9RJ");var l=function(t){s("+xsn")},o=s("VU/8")(e.a,n.a,!1,l,"data-v-e21f4b86",null);i.default=o.exports},A4rQ:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=s("xVVL"),e=s.n(a);for(var r in a)"default"!==r&&function(t){s.d(i,t,function(){return a[t]})}(r);var n=s("H8Qh");var l=function(t){s("T6fH")},o=s("VU/8")(e.a,n.a,!1,l,"data-v-8e78a164",null);i.default=o.exports},H8Qh:function(t,i,s){"use strict";var a={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{ref:"waterfallCont",staticClass:"general-waterfall"},t._l(t.realList,function(i,a){return s("div",{ref:"general_imgcol",refInFor:!0,staticClass:"general-imgcol",style:t.imgcolStyle},t._l(i,function(i){return s("a",{key:i.dataindex,staticClass:"general-imgcol-item",attrs:{href:i.objUrl,target:"_blank","data-index":i.dataindex}},[s("span",{staticClass:"general-imgcol-item-bg graph-imgbg-fff",attrs:{"data-click":'{"bt": "b-img"}'}}),t._v(" "),s("img",{attrs:{src:i.thumbUrl},on:{load:function(s){return t.loadBorder(s,i)}}})])}),0)}),0)},staticRenderFns:[]};i.a=a},O9RJ:function(t,i,s){"use strict";var a={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("gBase",{attrs:{extData:t.extData,dataIndex:t.dataIndex}},[t.isShow?s("div",{staticClass:"graph-similar graph-container"},[s("g-title",{attrs:{title:t.title,"type-list":t.tags,"cur-id":t.curId,"show-search":!0,"image-url":t.imageUrl},on:{changeItem:t.changeItem,changeText:t.changeText}}),t._v(" "),s("div",{staticClass:"graph-similar-list"},[s("waterfall",{attrs:{list:t.list,"more-url":t.moreUrl}})],1),t._v(" "),s("div",{staticClass:"graph-similar-list-bottom"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"graph-similar-list-bottom-status"},[t._v("\n                正在加载...\n            ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isError,expression:"isError"}],staticClass:"graph-similar-list-bottom-status"},[t._v("\n                No results :(\n            ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isComplete,expression:"isComplete"}],staticClass:"graph-similar-list-bottom-status"},[t._v("\n                没有更多\n            ")])])],1):t._e()])},staticRenderFns:[]};i.a=a},T6fH:function(t,i){},txtP:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=c(s("c/Tr")),e=c(s("woOf")),r=c(s("Ei4b")),n=c(s("A4rQ")),l=s("//Iv"),o=c(s("sgap")),u=c(s("hlZc")),h=s("7uja");function c(t){return t&&t.__esModule?t:{default:t}}i.default={name:"simipic",props:["tplData","extData","commonData","dataIndex"],data:function(){return{ajaxTextUrl:"",firstUrl:"",curId:0,title:"",tags:[],list:[],firstList:[],moreUrl:"",page:1,urlStatus:"first",query:"",panoImg:"",win:$(window),doc:$(document),disposeFn:[],status:"loaded",isShow:!1}},components:{gTitle:r.default,waterfall:n.default,gBase:o.default},computed:{isLoading:function(){return"loading"===this.status},isLoaded:function(){return"loaded"===this.status},isComplete:function(){return"complete"===this.status},isError:function(){return"error"===this.status}},methods:{doScroll:function(){if(!(this.isLoading||this.isComplete||this.isError)){var t=this.win.height(),i=this.doc.height();this.win.scrollTop()+t>=i&&(this.status="loading",this.addPage())}},addPage:function(){switch(this.page++,this.urlStatus){case"first":this.getListData(this.firstUrl+"&page="+this.page);break;case"query":this.getListData(this.ajaxTextUrl+"&tag="+this.query+"&page="+this.page);break;case"tags":this.getListData(this.tags[this.curId].ajaxUrl+"&page="+this.page)}},changeText:function(t){this.page=1,this.status="loading",this.query=t,t?(this.list=[],this.urlStatus="query",this.getListData(this.ajaxTextUrl+"&tag="+t+"&page="+this.page)):(u.default.sendLog({bt:"b-btn",clk_info:'{type: "by_text"}'}),this.panoImg?this.urlStatus="query":this.urlStatus="first",this.curId=0,this.list=this.firstList,this.list.length<30?this.status="complete":this.status="loaded")},getListData:function(t){var i=this;(0,l.get)(t).then(function(t){var s=t.body||{},a=(s.status,s.data);a.ajaxTextUrl&&"first"===i.urlStatus&&(i.ajaxTextUrl=a.ajaxTextUrl),a.tags&&"first"===i.urlStatus&&(i.tags=a.tags),i.panoImg&&"first"===i.urlStatus?i.changeText(i.panoImg):a.list&&30===a.list.length&&1===i.page?(i.list=a.list,i.isShow=!0,"first"!==i.urlStatus&&i.query!==i.panoImg||(i.firstList=i.list),i.status="loaded"):a.list&&30===a.list.length&&i.page>1?(i.list=i.list.concat(a.list),i.status="loaded"):a.list&&a.list.length<30&&a.list.length>0&&1===i.page?(i.list=i.list.concat(a.list),i.isShow=!0,"first"===i.urlStatus&&1===i.page&&(i.firstList=i.list),i.status="loaded"):i.status="complete"}).catch(function(t){i.status="error"})},changeItem:function(t){this.curId!==t&&(this.list=[],this.urlStatus="tags",this.page=1,this.status="loading",this.curId=t,this.getListData(this.tags[t].ajaxUrl+"&page="+this.page))}},created:function(){var t=this.tplData,i=t.title,s=t.firstUrl,a=t.moreUrl,r=t.imageUrl,n=t.panoImg;(0,e.default)(this,{title:i,moreUrl:a,imageUrl:r,firstUrl:s,panoImg:n})},mounted:function(){var t=this;this.status="loading",this.getListData(this.firstUrl+"&page="+this.page);var i=(0,h.debounce)(50,this.doScroll.bind(this));this.win.on("scroll",i),this.disposeFn.push(function(){return t.win.off("scroll",i)})},beforeDestroy:function(){(0,a.default)(this.disposeFn,function(t){t()})}}},xVVL:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a,e=s("woOf"),r=(a=e)&&a.__esModule?a:{default:a};i.default={name:"g-waterfall",data:function(){return{realList:[],imgcolStyle:{width:"20%"},limit:4,heightArr:[]}},props:{list:{type:Array,default:[]}},methods:{loadBorder:function(t,i){t.target.style.cssText="border: 1px solid rgba(0, 0, 0, .05);"},doResize:function(t){var i=$(this.$refs.waterfallCont).width();this.limit=i>1420?5:i<940?3:4,this.imgcolStyle.width=(i-20*(this.limit-1))/this.limit+"px",this.formatData()},formatData:function(t){var i=this;t||(t=this.list);for(var s=[],a=0;a<this.limit;a++)s[a]=[],this.heightArr[a]=0;t.forEach(function(t,a){for(var e=0,n=1;n<i.limit;n++)i.heightArr[n]<i.heightArr[e]&&(e=n);s[e].push((0,r.default)({},t,{dataindex:a}));var l=0;t.width&&t.height&&(l=parseInt(i.imgcolStyle.width,10)/t.width*t.height);var o=a>=i.limit?20:0;i.heightArr[e]+=l+o}),this.realList=s}},watch:{list:function(t){this.formatData(t)}},mounted:function(){var t=this;this.doResize(),window.addEventListener("resize",function(){t.doResize("resize")})}}}});